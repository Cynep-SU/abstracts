#+TITLE: Лабороторная работа № 16


* Введение
Для меня Linux, это тема большая нежели такая небольшая лабораторная работа и были вещи в которых мне хотелось давно разобраться. 
А именно **ArchLinux** и его довольно "непростая" установка.
* Установка ArchLinux и "куча проблем"
** Еще немного введения
Сама по себе установка ArchLinux, кажется рядовому пользователю довольно сложной, так как:
1. Вся установка происходит в консоли
   - Нет GUI
   - Нельзя просто вставить команду
   - Легко допустить ошибку, по не опытности
2. После установки мы получаем тоже консоль :)
   Как бы это не было смешно, но это и есть archlinux. 
   Но это не минус, это плюс, так как при этом пользователь может настроить всё под себя, хоть продолжить работу в этой консоли.
   Но мы поставим Gnome, так как нам необходимо использовать nautilus, который фактически является частью gnome.
   Всё равно стоит упомянуть, что его можно установить в любой оконный менеджер, нужно лишь устранить все зависимости.
3. Есть проблемы которые требуют сообразительности
   А именно, чтобы понять почему не работает интернет и как это можно исправить(это довольно приятный адский путь) или же почему не работает консоль в GNOME.
  Или вдруг почему не ставится нужный нам пакет. Об этом тоже будет идти речь.
** Сам процесс установки
Так как мы обязаны использовать виртуальную машину, то делаем в ней, а именно, выделяем память, выбираем образ и запускаем:

Нас встречает прекрасный выбор:

#+DOWNLOADED: screenshot @ 2022-04-05 23:55:21
[[file:images/20220405-235521_screenshot.png]]

Можем ничего не выбирать и автоматом перейдём на установку. Далее произойдёт компиляция ядра и откроется установщик:


#+DOWNLOADED: screenshot @ 2022-04-05 23:57:11
[[file:images/20220405-235711_screenshot.png]]

Нам надо разметить разделы и смонтировать диски. Для того чтобы просмотреть какие разделы нам доступны введём:

#+begin_src shell
fdisk -l
#+end_src

И увидим доступные разделы, а точнее диски:

#+DOWNLOADED: screenshot @ 2022-04-05 23:59:35
[[file:images/20220405-235935_screenshot.png]]

Для того чтобы разметить я пользуюсь удобной утилитой cfdisk:

#+DOWNLOADED: screenshot @ 2022-04-06 00:00:48
[[file:images/20220406-000048_screenshot.png]]

Она имеет довольно простой интерфейс и позволяет довольно быстро разметить нужные нам разделы.
У вас наверняка уже возник вопрос, что за разделы? 
Ну их не так много:
1. boot - отвечает за запуск системы
2. swap - это файл подкачки
3. / - наша оснавная память

В итоге получим подобную картину:

#+DOWNLOADED: screenshot @ 2022-04-06 00:06:54
[[file:images/20220406-000654_screenshot.png]]

Проверим прошлую команду:

#+DOWNLOADED: screenshot @ 2022-04-06 00:08:14
[[file:images/20220406-000814_screenshot.png]]

Теперь нам надо отформатировать эти разделы, под необходимые файловые системы:

#+begin_src shell
mkswap /dev/sda2
mkfs.fat -F 32 /dev/sda1
mkfs.ext /dev/sda3
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-06 00:12:55
[[file:images/20220406-001255_screenshot.png]]

И вот, уже треть дела сделана. Теперь необходимо смонтировать и провести скачивание и установку самой системы:

#+begin_src shell
mount /dev/sda1 /mnt/boot
mount /dev/sda3 /mnt
swapon /dev/sda2
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-06 00:20:48
[[file:images/20220406-002048_screenshot.png]]

А теперь просто пропишем одну команду и фактически установка закончена:

#+begin_src shell
pacstrap /mnt base linux linux-firmware
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-06 00:23:22
[[file:images/20220406-002322_screenshot.png]]


#+DOWNLOADED: screenshot @ 2022-04-06 00:23:40
[[file:images/20220406-002340_screenshot.png]]

** Первоначальная настройка
Фактически система уже есть, но нужна первоначальная настройка, без которой система будет работать адекватно.

- Fstab
  Это нам необходимо для корректной идентификации дисков по их UUID
  #+begin_src shell
  genfstab -U /mnt >> /mnt/etc/fstab
  #+end_src

Теперь же нам необходимо сделать вход в нашу установленную систему:

#+begin_src shell
arch-chroot /mnt
#+end_src

Фактически мы зайдём в систему под root. 
И я считаю это очень хорошей возможностью так как это даёт возможность восстановки пароля или восстановления системы, например из-за того что поставил абсолютно все файлы для чтения. 
Также это очень хорошо, для администрирования.


#+DOWNLOADED: screenshot @ 2022-04-06 00:41:20
[[file:images/20220406-004120_screenshot.png]]


*** Часовой пояс

#+begin_src shell
ln -sf /usr/share/zoneinfo/Russia/Moscow /etc/localtime
hwclock --systohc
#+end_src

*** Локализация

Скачаем nano, для редактирования файлов:
#+begin_src shell
pacman -S nano
#+end_src

#+DOWNLOADED: screenshot @ 2022-04-06 11:15:50
[[file:images/20220406-111550_screenshot.png]]

Отредактируем файл локализации:
#+begin_src shell
nano /etc/locale.gen
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-06 11:20:50
[[file:images/20220406-112050_screenshot.png]]

Декомментируем строчки с нужным нам языкам системы для нас это ru UTF-8 и US UTF-8

Генерация файла локализации:
#+begin_src shell
locale-gen
#+end_src

#+DOWNLOADED: screenshot @ 2022-04-06 11:25:13
[[file:images/20220406-112513_screenshot.png]]

Фактически мы можем дальше менять языки в нужных нам местах, но мы этого делать не будем, потому что нам сейчас это не очень необходимо.



*** Настройка сети

Настроем имя компьютера в сети(хотя фактически будет именем компьютера)

#+DOWNLOADED: screenshot @ 2022-04-06 11:34:50
[[file:images/20220406-113450_screenshot.png]]

Также в будуещем нам будет необходим доступ в интернет, поэтому установим службу dhcpcd

#+begin_src shell
pacman -S dhcpcd
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-06 11:42:41
[[file:images/20220406-114241_screenshot.png]]

Включаем эту службу:
#+begin_src shell
systemctl enable dhcpcd 
#+end_src

*** Установка пароля

Пароль устанавливается с помщью утилиты passwd:

#+DOWNLOADED: screenshot @ 2022-04-06 11:49:28
[[file:images/20220406-114928_screenshot.png]]

*** GRUB

GRUB - это загрузчик, который позволит нам правильно запускать систему, а так же позволит выбирать между системами, если они есть.

Для начала нам надо его установить, сделать это можно с помощью известной нам ранее команды pacman.

На этом скриншоте показана попытка установки grub, efi-директория и efi-bootmgr нам необходимы, так как были установлены разделы работающие только с uefi.

#+DOWNLOADED: screenshot @ 2022-04-06 12:07:49
[[file:images/20220406-120749_screenshot.png]]

Но это не всё... Да, Grub для меня был самой сложной частью, так как он требует частых перезагрузок, которые по своей сути не решали проблемы. 
Далее я донастраиваю grub с помощью специальной утилиты.

#+DOWNLOADED: screenshot @ 2022-04-11 21:03:58
[[file:images/20220411-210358_screenshot.png]]

По логике всё должно запуститься и мы увидим это, после перезапуска(после прогрузки выбора систем):

#+DOWNLOADED: screenshot @ 2022-04-11 21:13:53
[[file:images/20220411-211353_screenshot.png]]

Всё, система установлена.

* GNOME
Так как в начале у нас лишь консоль, то нам надо установить визуалььное окружение, а так как нам надо работать с nautilus, то это будет GNOME. 
Для этого нам в начале нужно установить, фактически ядро графики Xorg.
#+begin_src shell
pacman -S xorg
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-11 21:21:25
[[file:images/20220411-212125_screenshot.png]]

Далее уже устанавливаем gnome.

#+begin_src shell
pacman -S gnome
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-11 21:22:47
[[file:images/20220411-212247_screenshot.png]]

После надо активировать службу, и... всё!!!
#+begin_src shell
systemctl enable gdm
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-11 21:30:43
[[file:images/20220411-213043_screenshot.png]]

* Индивидуальное задание
Используя проводник файлов Nautilus создать в каталоге /home/имя пользователя/ папку с названием предмета, где будут содержаться отчеты по лабораторным работам. 
Также научиться производить основные операции над файлами, включая создание, копирова-ние, переименование файлов и удаление. 
Отсортировать файлы по имени.


#+DOWNLOADED: screenshot @ 2022-04-06 12:27:10
[[file:images/20220406-122710_screenshot.png]]


#+DOWNLOADED: screenshot @ 2022-04-06 12:29:12
[[file:images/20220406-122912_screenshot.png]]


#+DOWNLOADED: screenshot @ 2022-04-06 12:29:38
[[file:images/20220406-122938_screenshot.png]]


Так как у меня часть лабораторных работ хранится на GitHub, то давайте их выкачаем, с помощью git:

#+begin_src shell
git clone https://github.com/Cynep-SU/abstracts.git
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-11 21:42:45
[[file:images/20220411-214245_screenshot.png]]

Полученные конспекты:

#+DOWNLOADED: screenshot @ 2022-04-11 21:43:43
[[file:images/20220411-214343_screenshot.png]]

Теперь зайдём и скопируем ОСиС:

#+DOWNLOADED: screenshot @ 2022-04-11 21:45:34
[[file:images/20220411-214534_screenshot.png]]


#+DOWNLOADED: screenshot @ 2022-04-11 21:46:15
[[file:images/20220411-214615_screenshot.png]]


#+DOWNLOADED: screenshot @ 2022-04-11 21:46:40
[[file:images/20220411-214640_screenshot.png]]


Итог: Nautilus, очень схож с другими файловыми менеджерами, но обладает рядам минусами, например: нельзя копировать путь, путь не отображается, 
использовать возможности администратора где это необходимо(например редактирование конфигурационных файлов) и в общем обладает скудным функционалом. 
Но при этом хорошо вписывается в своё окружение GNOME и в последнее время активно дорабатывается.

* Контрольные вопросы

Ну их я позже спишу.
