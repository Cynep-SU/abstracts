#+TITLE: Лабороторная работа № 16


* Введение
Для меня Linux, это тема большая нежели такая небольшая лабораторная работа и были вещи в которых мне хотелось давно разобраться. 
А именно **ArchLinux** и его довольно "непростая" установка.
* Установка ArchLinux и "куча проблем"
** Еще немного введения
Сама по себе установка ArchLinux, кажется рядовому пользователю довольно сложной, так как:
1. Вся установка происходит в консоли
   - Нет GUI
   - Нельзя просто вставить команду
   - Легко допустить ошибку, по не опытности
2. После установки мы получаем тоже консоль :)
   Как бы это не было смешно, но это и есть archlinux. 
   Но это не минус, это плюс, так как при этом пользователь может настроить всё под себя, хоть продолжить работу в этой консоли.
   Но мы поставим Gnome, так как нам необходимо использовать nautilus, который фактически является частью gnome.
   Всё равно стоит упомянуть, что его можно установить в любой оконный менеджер, нужно лишь устранить все зависимости.
3. Есть проблемы которые требуют сообразительности
   А именно, чтобы понять почему не работает интернет и как это можно исправить(это довольно приятный адский путь) или же почему не работает консоль в GNOME.
  Или вдруг почему не ставится нужный нам пакет. Об этом тоже будет идти речь.
** Сам процесс установки
Так как мы обязаны использовать виртуальную машину, то делаем в ней, а именно, выделяем память, выбираем образ и запускаем:

Нас встречает прекрасный выбор:

#+DOWNLOADED: screenshot @ 2022-04-05 23:55:21
[[file:images/20220405-235521_screenshot.png]]

Можем ничего не выбирать и автоматом перейдём на установку. Далее произойдёт компиляция ядра и откроется установщик:


#+DOWNLOADED: screenshot @ 2022-04-05 23:57:11
[[file:images/20220405-235711_screenshot.png]]

Нам надо разметить разделы и смонтировать диски. Для того чтобы просмотреть какие разделы нам доступны введём:

#+begin_src shell
fdisk -l
#+end_src

И увидим доступные разделы, а точнее диски:

#+DOWNLOADED: screenshot @ 2022-04-05 23:59:35
[[file:images/20220405-235935_screenshot.png]]

Для того чтобы разметить я пользуюсь удобной утилитой cfdisk:

#+DOWNLOADED: screenshot @ 2022-04-06 00:00:48
[[file:images/20220406-000048_screenshot.png]]

Она имеет довольно простой интерфейс и позволяет довольно быстро разметить нужные нам разделы.
У вас наверняка уже возник вопрос, что за разделы? 
Ну их не так много:
1. boot - отвечает за запуск системы
2. swap - это файл подкачки
3. / - наша оснавная память

В итоге получим подобную картину:

#+DOWNLOADED: screenshot @ 2022-04-06 00:06:54
[[file:images/20220406-000654_screenshot.png]]

Проверим прошлую команду:

#+DOWNLOADED: screenshot @ 2022-04-06 00:08:14
[[file:images/20220406-000814_screenshot.png]]

Теперь нам надо отформатировать эти разделы, под необходимые файловые системы:

#+begin_src shell
mkswap /dev/sda2
mkfs.fat -F 32 /dev/sda1
mkfs.ext /dev/sda3
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-06 00:12:55
[[file:images/20220406-001255_screenshot.png]]

И вот, уже треть дела сделана. Теперь необходимо смонтировать и провести скачивание и установку самой системы:

#+begin_src shell
mount /dev/sda1 /mnt/boot
mount /dev/sda3 /mnt
swapon /dev/sda2
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-06 00:20:48
[[file:images/20220406-002048_screenshot.png]]

А теперь просто пропишем одну команду и фактически установка закончена:

#+begin_src shell
pacstrap /mnt base linux linux-firmware
#+end_src


#+DOWNLOADED: screenshot @ 2022-04-06 00:23:22
[[file:images/20220406-002322_screenshot.png]]


#+DOWNLOADED: screenshot @ 2022-04-06 00:23:40
[[file:images/20220406-002340_screenshot.png]]

** Первоначальная настройка
Фактически система уже есть, но нужна первоначальная настройка, без которой система будет работать адекватно.

- Fstab
  Это нам необходимо для корректной идентификации дисков по их UUID
  #+begin_src shell
  genfstab -U /mnt >> /mnt/etc/fstab
  #+end_src

Теперь же нам необходимо сделать вход в нашу установленную систему:

#+begin_src shell
arch-chroot /mnt
#+end_src

Фактически мы зайдём в систему под root. 
И я считаю это очень хорошей возможностью так как это даёт возможность восстановки пароля или восстановления системы, например из-за того что поставил абсолютно все файлы для чтения. 
Также это очень хорошо, для администрирования.


#+DOWNLOADED: screenshot @ 2022-04-06 00:41:20
[[file:images/20220406-004120_screenshot.png]]


*** Часовой пояс

#+begin_src shell
ln -sf /usr/share/zoneinfo/Russia/Moscow /etc/localtime
hwclock --systohc
#+end_src

*** Локализация

я устал, ну там блин есть русская документация:) : https://wiki.archlinux.org/title/installation_guide_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)
